if(!window.ComponentArt_ComboBox_Kernel_Loaded){function ComponentArt_ComboBox(id){this.DomElementId=id;this.element=this.DomElement=document.getElementById(this.DomElementId);if(window.ComponentArt_Atlas){ComponentArt.Web.UI.ComboBox.initializeBase(this,[this.element]);this.beginUpdate=function(){this._updating=true;};this.dispose=function(){ComponentArt.Web.UI.ComboBox.callBaseMethod(this,"dispose");this.Dispose();};this.endUpdate=function(){this._updating=false;this.Render(true);};this.get_isUpdating=function(){return this._updating;};this.getDescriptor=function(){return _qE4(this.constructor);};}else{this.beginUpdate=function(){this._updating=true;};this.endUpdate=function(){this._updating=false;this.Render(true);};this.get_isUpdating=function(){return this._updating;};}this.ClientControlId=this.Id=id;this.ItemHeight=10;}ComponentArt_ComboBox.prototype.PublicProperties=[["CssClass",String],["ItemCount",Number],["SelectedIndex",Number,1],["Text",String,1,1],["TextBoxCssClass",String]];ComponentArt_ComboBox.prototype.PublicMethods=[["AddItem",,null,[["item",Object],["index",Number]]],["Collapse"],["Disable"],["Dispose"],["Enable"],["Expand"],["Filter",,null,[["filterString",String]]],["Focus"],["GetItem",,Object,[["index",Number]]],["GetSelectedItem",,Object],["RemoveItemAt",,null,[["index",Number]]],["SelectItem",,null,[["item",Object]]],["SelectItemByIndex",,null,[["id",String]]],["ToggleExpand"]];ComponentArt_ComboBox.prototype.PublicEvents=[["CallbackComplete"],["CallbackError"],["Change"],["Collapse"],["Expand"],["Load"]];_qE3(ComponentArt_ComboBox);window.ComponentArt.Web.UI.ComboBox=window.ComponentArt_ComboBox;if(window.ComponentArt_Atlas){ComponentArt.Web.UI.ComboBox.registerClass("ComponentArt.Web.UI.ComboBox",Sys.UI.Control);if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","comboBox",ComponentArt.Web.UI.ComboBox);}}function ComponentArt_ComboBoxItem(_2){if(window.ComponentArt_Atlas){ComponentArt.Web.UI.ComboBoxItem.initializeBase(this);this.getDescriptor=function(){return _qE4(this.constructor);};}this.Enabled=true;if(_2){this.Data=_2;}else{this.Data=[];}}ComponentArt_ComboBoxItem.prototype.PublicProperties=[["Enabled"],["Id"],["Text"],["Value"]];ComponentArt_ComboBoxItem.prototype.PublicMethods=[["GetProperty",,Object],["SetProperty",,,[["propertyName",String],["propertyValue",Object]]]];_qE3(ComponentArt_ComboBoxItem);window.ComponentArt.Web.UI.ComboBoxItem=window.ComponentArt_ComboBoxItem;if(window.ComponentArt_Atlas){ComponentArt.Web.UI.ComboBoxItem.registerClass("ComponentArt.Web.UI.ComboBoxItem");if(Sys.TypeDescriptor){Sys.TypeDescriptor.addType("componentArtWebUI","comboBoxItem",ComponentArt.Web.UI.ComboBoxItem);}}ComponentArt_ComboBoxItem.prototype.GetProperty=function(_3,_4){for(var i=0;i<this.Data.length;i++){if(this.Data[i][0]==_3){return this.Data[i][1];}}return _4;};ComponentArt_ComboBoxItem.prototype.SetProperty=function(_6,_7){var _8=false;for(var i=0;i<this.Data.length;i++){if(this.Data[i][0]==_6){this.Data[i][1]=_7;_8=true;break;}}if(!_8){this.Data[this.Data.length]=[_6,_7];}this[_6]=_7;};ComponentArt_ComboBox.prototype.get_text=function(){var _a=document.getElementById(this.Id+"_Input");return _a?_a.value:"";};ComponentArt_ComboBox.prototype.set_text=function(_b){var _c=document.getElementById(this.Id+"_Input");if(_c){_c.value=_b;this.HandleInputChange();}};ComponentArt_ComboBox.prototype.GetProperty=function(_d){return this[_d];};ComponentArt_ComboBox.prototype.SetProperty=function(_e,_f){this[_e]=_f;};ComponentArt_ComboBox.prototype.AddItem=function(_10,_11){if(!(_11||_11==0)){_11=this.Data.length;}this.Data=this.Data.slice(0,_11).concat([_10.Data]).concat(this.Data.slice(_11));this.ItemCount++;this.LoadedItemCount++;this.TextCache.length=0;this.CssClasses.length=0;};ComponentArt_ComboBox.prototype.Callback=function(url,_13){if(this.CallingBack){return false;}var _14=this;var _15=false;var _16;function Cleanup(){_14.CallingBack=false;_14.HideReloading();if(_14.AutoComplete||_14.AutoHighlight){_14.CompleteAndHighlight();}}function _q18C(){if(_16.readyState&&_16.readyState!=4&&_16.readyState!="complete"){return;}var _17=_15?_16.responseXML:_16;if(_17&&_17.documentElement&&_17.documentElement.childNodes.length==2){var _18=_17.documentElement.childNodes[0];var _19=_17.documentElement.childNodes[1];if(_18.nodeName=="ComboBoxError"){var _1a=_18.firstChild.nodeValue;var _1b=_14.get_events().getHandler("callbackError");if(_1b){_1b(_14,new ComponentArt.Web.UI.ComboBoxCallbackErrorEventArgs(_1a));}else{alert("Callback error:\n"+_1a);}}else{var _1c=_18.firstChild.nodeValue;var _1d=eval(_1c);_14.LoadItems(_1d,_13);_14.LoadParams(_19.childNodes);_14.Render(true);}}else{if(_16.status&&_16.status!=200&&_16.responseText){document.body.innerHTML=_16.responseText;}else{alert("Error loading callback data.");}}Cleanup();var _1b=_14.get_events().getHandler("callbackComplete");if(_1b){_1b(_14,Sys.EventArgs.Empty);}}this.CallingBack=true;if(window.XMLHttpRequest){_15=true;var _16=new XMLHttpRequest();_16.onreadystatechange=_q18C;_16.open("GET",url,true);_16.send(null);}else{if(document.implementation&&document.implementation.createDocument){_16=document.implementation.createDocument("","",null);_16.onload=_q18C;}else{if(cart_browser_ie){var _1e=this.Id+"_island";var _1f=document.getElementById(_1e);if(!_1f){_1f=document.createElement("xml");_1f.id=_1e;document.body.appendChild(_1f);}if(_1f.XMLDocument){_16=_1f.XMLDocument;_16.onreadystatechange=_q18C;}else{return false;}}else{return false;}}}if(!_15){_16.async=true;try{_16.load(url);}catch(ex){Cleanup();alert("Data not loaded: "+(ex.message?ex.message:ex));}}return true;};ComponentArt_ComboBox.prototype.Collapse=function(){if(this.Resizing){return;}var _20=document.getElementById(this.Id+"_DropDown");if(_20&&_20.style.display!="none"){_20.style.overflow="hidden";this.CollapseElement=_20;this.CollapseStartTime=(new Date()).getTime();var _21=ComponentArt_GetAdjustedHeight(_20);ComponentArt_ComboBox_CollapseStep(this,_21);}this.Expanded=false;};ComponentArt_ComboBox.prototype.CollapseIfBlurred=function(){if(document.activeElement){var _22=document.getElementById(this.Id+"_DropDown");for(var o=document.activeElement;o.parentNode&&o.parentNode!=document.body;o=o.parentNode){if(o.parentNode==_22){this.Focus();break;}}}if(!this.Focused){this.Collapse();}};ComponentArt_ComboBox.prototype.CompleteAndHighlight=function(){var _24=document.getElementById(this.Id+"_Input");if(!_24){return;}if(!_24.value){if(this.SelectedIndex>=0){this.UnSelect();}return;}var _25=_q103(_24);if(!_25){return;}var _26=_24.value.toLowerCase().substring(0,_25);var _27=false;for(var i=0;i<this.TextCache.length;i++){var _29=this.TextCache[i];if(_29&&_29.toLowerCase().indexOf(_26)==0){if(this.AutoComplete){_24.value=_29;this.SelectItemByIndex(i);ComponentArt_SetSelectionRange(_24,_26.length,_24.value.length);}if(this.AutoHighlight){if(!this.AutoComplete){this.SelectItemByIndex(i);}this.Expand();}_27=true;break;}}if(!_27&&this.SelectedIndex>=0){this.UnSelect();}};ComponentArt_ComboBox.prototype.Disable=function(){if(this.element){this.element.disabled=true;}if(this.TextBoxEnabled){var _2a=document.getElementById(this.Id+"_Input");if(_2a){_2a.disabled=true;if(this.TextBoxDisabledCssClass&&this.TextBoxCssClass){_2a.className=this.TextBoxDisabledCssClass;}}}else{var _2b=document.getElementById(this.Id+"_TextBox");if(_2b){if(this.TextBoxDisabledCssClass&&this.TextBoxCssClass){_2b.className=this.TextBoxDisabledCssClass;}}}this.Collapse();if(this.DisabledCssClass&&this.CssClass){this.element.className=this.DisabledCssClass;}this.Disabled=true;};ComponentArt_ComboBox.prototype.Dispose=function(){ComponentArt_Dispose(this);this.CollapseElement=this.ExpandElement=null;if(this.OverlayElement){_qE7(this.OverlayElement);}if(this.CallbackProgressDomObj){_qE7(this.CallbackProgressDomObj);}if(this.ContainerObj){_qE7(this.ContainerObj);}};ComponentArt_ComboBox.prototype.Enable=function(){if(this.element){this.element.disabled=false;}if(this.TextBoxEnabled){var _2c=document.getElementById(this.Id+"_Input");if(_2c){_2c.disabled=false;if(this.TextBoxDisabledCssClass&&this.TextBoxCssClass){_2c.className=this.TextBoxCssClass;}}}else{var _2d=document.getElementById(this.Id+"_TextBox");if(_2d){if(this.TextBoxDisabledCssClass&&this.TextBoxCssClass){_2d.className=this.TextBoxCssClass;}}}if(this.DisabledCssClass&&this.CssClass){this.element.className=this.CssClass;}this.Disabled=false;};ComponentArt_ComboBox.prototype.EnsureDomElement=function(){this.element=this.DomElement=document.getElementById(this.DomElementId);};ComponentArt_ComboBox.prototype.Expand=function(){this.EnsureDomElement();var _2e=document.getElementById(this.Id+"_DropDown");var _2f=document.getElementById(this.Id+"_DropDownContent");if(_2e&&_2e.style.display=="none"){var x=_q85(this.element);var y=this.ExpandBaseLine=_q86(this.element)+(this.ExpandDirection==0?ComponentArt_GetAdjustedHeight(this.element):-1);var _32=ComponentArt_ComboBox_GetRelativeOffsetX(_2e);var _33=ComponentArt_ComboBox_GetRelativeOffsetY(_2e);if(_32<x){x-=_32;}if(_33<y){y-=_33;}_2e.style.zIndex=90210;_2e.style.position="absolute";_2e.style.top=y+"px";_2e.style.left=x+"px";_2e.style.height="";_2e.style.visibility="hidden";_2e.style.display="";if(!this.DropDownWidth){this.DropDownWidth=ComponentArt_GetAdjustedWidth(this.element);}_2e.style.width=this.DropDownWidth+"px";_2f.style.width=this.DropDownWidth-(this.CacheMapWidth?this.CacheMapWidth:0)+"px";if(!this.DropDownHeight){if(this.HasDropDownContent){this.DropDownHeight=ComponentArt_GetAdjustedHeight(_2f);this.ItemHeight=0;}else{if(_2f.childNodes.length>this.DropDownPageSize){this.DropDownHeight=_2f.childNodes[this.DropDownPageSize].offsetTop;this.ItemHeight=Math.round(this.DropDownHeight/this.DropDownPageSize);}else{this.ItemHeight=ComponentArt_GetAdjustedHeight(_2f.firstChild);this.DropDownHeight=this.ItemHeight*this.DropDownPageSize;}}}_2f.style.height=this.DropDownHeight+"px";_2f.style.overflow="auto";_2f.style.overflowX="hidden";var _34=ComponentArt_GetAdjustedHeight(_2e);_2e.style.height="1px";_2e.style.overflow="hidden";_2e.style.visibility="";this.ExpandStartTime=(new Date()).getTime();this.ExpandElement=_2e;ComponentArt_ComboBox_ExpandStep(this,_34);this.DropDownX=x;this.DropDownY=y;}this.Expanded=true;};ComponentArt_ComboBox.prototype.Fetch=function(_35,_36){var _37=document.getElementById(this.Id+"_CacheMap");if(_37){for(var i=_35;i<_35+_36;i++){this.Data[i]=[];}this.RenderCacheMap(_37);}var url=this.CallbackPrefix+"&Cart_"+this.Id+"_Callback_StartIndex="+_35+"&Cart_"+this.Id+"_Callback_NumItems="+_36;if(this.CallbackFilterString){url+="&Cart_"+this.Id+"_Callback_Filter="+this.CallbackFilterString;}this.LoadedItemCount+=_36;while(this.LoadedItemCount>this.CacheSize){this.UnloadStalePage();}this.Callback(url,_35);};ComponentArt_ComboBox.prototype.Filter=function(_3a){if(this.RunningMode==0){this.FilterString=_3a.toLowerCase();this.RenderDropDown();return true;}else{if(_3a&&this.CallbackFilterString&&_3a.indexOf(this.CallbackFilterString)==0&&this.Data.length==this.ItemCount){this.FilterString=_3a.toLowerCase();this.CallbackFilterString=_3a;this.RenderDropDown();return true;}var _3b=false;var _3c=false;if(this.FilterCache){var _3d=_3a.toLowerCase();var _3e=this.CallbackFilterString?this.CallbackFilterString.toLowerCase():"";var _3f=[_3e,this.ItemCount,this.Data.concat()];for(var i=0;i<this.FilterCache.length;i++){if(this.FilterCache[i][0]==_3d){_3b=true;this.CallbackFilterString=_3a;this.ItemCount=this.FilterCache[i][1];this.Data=this.FilterCache[i][2].concat();}if(this.FilterCache[i][0]==_3e){_3c=true;}}if(_3f&&!_3c){this.FilterCache=[_3f].concat(this.FilterCache);if(this.FilterCache.length>this.FilterCacheSize){this.FilterCache.length=this.FilterCacheSize;}}}this.FilterString=null;if(_3b){this.RenderDropDown();return true;}else{this.Data.length=0;this.CallbackFilterString=_3a;this.ShowReloading();this.Fetch(0,this.DropDownPageSize*2);return false;}}};ComponentArt_ComboBox.prototype.Focus=function(){var _41=document.getElementById(this.Id+"_Input");if(_41){try{_41.focus();}catch(ex){}}this.Focused=true;};ComponentArt_ComboBox.prototype.GetClientTemplate=function(sID){if(this.ClientTemplates){for(var i=0;i<this.ClientTemplates.length;i++){if(this.ClientTemplates[i][0]==sID){return this.ClientTemplates[i][1];}}}return null;};ComponentArt_ComboBox.prototype.GetItem=function(_44){if(this.Data.length>_44&&_44>=0){var _45=this.Data[_44];if(_45){var _46=new ComponentArt_ComboBoxItem(_45);for(var i=0;i<_45.length;i++){_46[_45[i][0]]=_45[i][1];}if(_46.Text==null){_46.Text="";}_46.ParentComboBox=this;_46.Index=_44;return _46;}else{return null;}}return null;};ComponentArt_ComboBox.prototype.GetSelectedItem=function(){if(this.SelectedIndex>=0){return this.GetItem(this.SelectedIndex);}return null;};ComponentArt_ComboBox.prototype.HandleBlur=function(e){if(this.CssClass&&this.FocusedCssClass&&this.element){this.element.className=this.CssClass;}if(this.TextBoxFocusedCssClass){if(this.TextBoxEnabled){var _49=document.getElementById(this.Id+"_Input");if(_49){_49.className=this.TextBoxCssClass;}}else{var _4a=document.getElementById(this.Id+"_TextBox");if(_4a){_4a.className=this.TextBoxCssClass;}}}this.Focused=false;setTimeout(this.Id+".CollapseIfBlurred()",100);};ComponentArt_ComboBox.prototype.HandleClick=function(e,o,_4d){this.Collapse();this.SelectItemByIndex(_4d);if(this.AutoPostBack){this.Postback();}};ComponentArt_ComboBox.prototype.HandleDropClick=function(e,o){ComponentArt_CancelEvent(e);if(!this.Disabled){if(this.DropActiveImageUrl){o.src=this.DropActiveImageUrl;}this.ToggleExpand();setTimeout(this.Id+".Focus()",10);}return false;};ComponentArt_ComboBox.prototype.HandleDropMouseUp=function(e,o){if(this.DropActiveImageUrl){if(this.DropHoverImageUrl){e.src=this.DropHoverImageUrl;}else{e.src=this.DropImageUrl;}}};ComponentArt_ComboBox.prototype.HandleFocus=function(){this.EnsureDomElement();window._q126=this;if(this.FocusedCssClass&&this.element){this.element.className=this.FocusedCssClass;}if(this.TextBoxEnabled){var _52=document.getElementById(this.Id+"_Input");_52.select();}if(this.TextBoxFocusedCssClass){if(this.TextBoxEnabled){var _52=document.getElementById(this.Id+"_Input");if(_52){_52.className=this.TextBoxFocusedCssClass;}}else{var _53=document.getElementById(this.Id+"_TextBox");if(_53){_53.className=this.TextBoxFocusedCssClass;}}}this.Focused=true;};ComponentArt_ComboBox.prototype.HandleInputChange=function(){var _54=document.getElementById(this.Id+"_Input");if(_54.value!=this.InputValue){this.InputValue=_54.value;}else{return;}var _55=_q103(_54);var _56=this.GetSelectedItem();if(_56&&_56.Text==this.InputValue){return;}if(this.AutoFilter){var _57=_54.value;_57=_57.substring(0,_55);if(this.RunningMode==1){this.Expand();clearTimeout(this.FilterTimeout);this.FilterTimeout=setTimeout("if("+this.Id+".Filter('"+_57.replace("'","\\'")+"')) {"+this.Id+".CompleteAndHighlight(); }",250);return;}else{this.Filter(_57);this.Expand();}}if(this.AutoComplete||this.AutoHighlight){this.CompleteAndHighlight();}};ComponentArt_ComboBox.prototype.HandleInputMouseOut=function(e,o){if(this.TextBoxHoverCssClass){if(this.TextBoxEnabled){var _5a=document.getElementById(this.Id+"_Input");if(_5a){_5a.className=this.TextBoxCssClass;}}else{var _5b=document.getElementById(this.Id+"_TextBox");if(_5b){_5b.className=this.TextBoxCssClass;}}}if(this.DropHoverImageUrl){var _5c=document.getElementById(this.Id+"_DropImage");if(_5c){_5c.src=this.DropImageUrl;}}if(this.CssClass&&this.HoverCssClass&&this.element){this.element.className=this.CssClass;}};ComponentArt_ComboBox.prototype.HandleInputMouseOver=function(e,o){if(this.TextBoxHoverCssClass){if(this.TextBoxEnabled){var _5f=document.getElementById(this.Id+"_Input");if(_5f&&_5f.className==this.TextBoxCssClass){_5f.className+=" "+this.TextBoxHoverCssClass;}}else{var _60=document.getElementById(this.Id+"_TextBox");if(_60&&_60.className==this.TextBoxCssClass){_60.className+=" "+this.TextBoxHoverCssClass;}}}if(this.DropHoverImageUrl){var _61=document.getElementById(this.Id+"_DropImage");if(_61){_61.src=this.DropHoverImageUrl;}}if(this.CssClass&&this.HoverCssClass&&this.element&&this.element.className==this.CssClass){this.element.className+=" "+this.HoverCssClass;}};ComponentArt_ComboBox.prototype.HandleItemMouseOver=function(e,o,_64){try{if(ComponentArt_Contains(o,ComponentArt_FromElement(e))){return;}}catch(ex){}o.className+=" "+this.CssClasses[_64].Hover;};ComponentArt_ComboBox.prototype.HandleItemMouseOut=function(e,o,_67){try{if(ComponentArt_Contains(o,ComponentArt_ToElement(e))){return;}}catch(ex){}o.className=this.CssClasses[_67].Base;};ComponentArt_ComboBox.prototype.HandleKeyPress=function(e,o){var _6a=cart_browser_ie?e.keyCode:e.which;if(_6a==8){var _6b=_q103(o);if(_6b>1){o.value=o.value.substring(0,_6b-1);ComponentArt_SetSelectionRange(o,_6b-1,o.value.length);}else{o.value="";ComponentArt_SetSelectionRange(o,0,0);}ComponentArt_CancelEvent(e);}else{if(_6a==13){this.Collapse();ComponentArt_CancelEvent(e);if(this.AutoPostBack){this.Postback();}return;}}setTimeout(this.Id+".HandleInputChange()",1);};ComponentArt_ComboBox.prototype.HandleMouseDown=function(e,o){ComponentArt_CancelEvent(e);if(this.ResizeArea){_qE1=this;var _6e=document.getElementById(this.Id+"_DropDown");if(this.DropDownResizingStyle=="Outline"){ComponentArt_ComboBox_ResizingContentObj=null;ComponentArt_ComboBox_ResizingFrameObj=document.createElement("div");ComponentArt_ComboBox_ResizingFrameObj.style.zIndex=90211;ComponentArt_ComboBox_ResizingFrameObj.style.border="1px solid #505050";ComponentArt_ComboBox_ResizingFrameObj.style.position="absolute";ComponentArt_ComboBox_ResizingFrameObj.style.top=_q86(_6e)+"px";ComponentArt_ComboBox_ResizingFrameObj.style.left=_q85(_6e)+"px";ComponentArt_ComboBox_ResizingFrameObj.style.height=ComponentArt_GetAdjustedHeight(_6e)+"px";ComponentArt_ComboBox_ResizingFrameObj.style.width=ComponentArt_GetAdjustedWidth(_6e)+"px";document.body.insertBefore(ComponentArt_ComboBox_ResizingFrameObj,document.body.firstChild);}else{ComponentArt_ComboBox_ResizingContentObj=document.getElementById(this.Id+"_DropDownContent");ComponentArt_ComboBox_ResizingFrameObj=_6e;}ComponentArt_ComboBox_ResizingLastX=cart_browser_ie?event.clientX+(document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):e.pageX;ComponentArt_ComboBox_ResizingLastY=cart_browser_ie?event.clientY+(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):e.pageY;this.Resizing=true;var _6f=document.getElementById(this.Id+"_CacheMap");if(_6f){_6f.innerHTML="";}document.onmousemove=_qDF;document.onmouseup=_qE0;}setTimeout(this.Id+".Focus()",10);return false;};ComponentArt_ComboBox.prototype.HandleMouseMove=function(e,o){var _72=15;if(this.Resizing){return true;}else{var _73=cart_browser_ie?event.clientX+(document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):e.pageX;var _74=cart_browser_ie?event.clientY+(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):e.pageY;var _75=this.DropDownHeight;var _76=this.DropDownWidth;if(this.DropDownResizingMode!="Off"){var _77=document.getElementById(this.Id+"_DropDown");if(_77){_75=ComponentArt_GetAdjustedHeight(_77);}}if(this.DropDownResizingMode=="Corner"){if(Math.abs(_73-(this.DropDownX+_76))<_72&&Math.abs(_74-(this.DropDownY+_75))<_72){this.ResizeArea=true;o.style.cursor="se-resize";}}else{if(this.DropDownResizingMode=="Bottom"){if(Math.abs(_74-(this.DropDownY+_75))<_72){this.ResizeArea=true;o.style.cursor="s-resize";}}}}};ComponentArt_ComboBox.prototype.HandleMouseOut=function(e,o){this.ResizeArea=false;o.style.cursor="";};ComponentArt_ComboBox.prototype.HandleMouseUp=function(e,o){if(this.Scrolling){clearTimeout(this.FetchTimeout);this.HandleScrollFetch();}};ComponentArt_ComboBox.prototype.HandleScroll=function(){if(this.RunningMode!=1){return;}var o=document.getElementById(this.Id+"_DropDownContent");this.Scrolling=true;var _7d=Math.round((o.scrollTop*(this.ItemCount-1))/(o.scrollHeight-o.offsetHeight));clearTimeout(this.FetchTimeout);if(_7d>=0&&_7d<this.ItemCount){var _7e=Math.floor(_7d/this.DropDownPageSize);this.PageViews[_7e]=++this.PageViewOrder;this.ScrollIndex=_7d;this.FetchTimeout=setTimeout(this.Id+".HandleScrollFetch()",500);}};ComponentArt_ComboBox.prototype.HandleScrollFetch=function(){this.Scrolling=false;var _7f=this.ScrollIndex;var _80=this.DropDownPageSize*2;var _81=_7f-_7f%this.DropDownPageSize;var _82=_81+this.DropDownPageSize;if(!this.Data[_7f]||!this.Data[_81]||!this.Data[_82]){var _83=!this.Data[_7f]?_7f:!this.Data[_81]?_81:_82;var _84=_83;for(var i=0;i<_80&&_84>0;i++){if(this.Data[_84-1]){break;}_84--;}var _86=_83;for(var i=0;i<_80&&_86<this.ItemCount;i++){if(this.Data[_86]){break;}_86++;}this.Fetch(_84,_86-_84);}};ComponentArt_ComboBox.prototype.HideOverlay=function(){if(this.OverlayElement){this.OverlayElement.style.display="none";}};ComponentArt_ComboBox.prototype.HideReloading=function(){if(this.CallbackProgressDomObj){this.CallbackProgressDomObj.style.display="none";}};ComponentArt_ComboBox.prototype.Initialize=function(){_q121(this);if(this.EnableViewState){ComponentArt_ClientStateControls[ComponentArt_ClientStateControls.length]=this;}this.PageViews=[1];this.PageViewOrder=1;this.LoadedItemCount=this.Data.length;this.TextCache=[];this.CssClasses=[];if(this.AutoFilter){this.FilterCache=[];}var _87=document.getElementById(this.Id+"_Input");if(_87){_87.style.width="1px";_87.style.visibility="hidden";_87.style.display="";var _88=ComponentArt_GetAdjustedWidth(_87.parentNode)+ComponentArt_GetAdjustedWidth(_87,0);if(_88>10){_87.style.width=_88+"px";}else{if(this.Width){_87.style.width=this.Width+"px";}}_87.style.visibility="";_87.ComponentArtInput=true;_87.autocomplete="off";_87.onsubmit=ComponentArt_CancelEvent;}var _89=document.createElement("div");_89.style.position="absolute";_89.style.visibility="hidden";document.body.insertBefore(_89,document.body.firstChild);this.ContainerObj=_89;this.Render(true);var _8a=document.getElementById(this.Id+"_DropDownContent");if(_8a){_8a.onscroll=new Function(this.Id+".HandleScroll()");_8a.onfocus=new Function(this.Id+".Focus()");}if(!this.Enabled){this.Disable();}var _8b=this.get_events().getHandler("load");if(_8b){_8b(this,Sys.EventArgs.Empty);}};ComponentArt_ComboBox.prototype.LoadItems=function(_8c,_8d){if(_8c.length>0){for(var i=0;i<_8c.length;i++){this.Data[_8d+i]=_8c[i];var _8f=Math.floor((_8d+i)/this.DropDownPageSize);this.PageViews[_8f]=++this.PageViewOrder;}}};ComponentArt_ComboBox.prototype.LoadParams=function(_90){for(var _91=0;_91<_90.length;_91++){var _92=_90.item(_91);var _93=_92.nodeName;var _94=_92.firstChild?_92.firstChild.nodeValue:null;this[_93]=_94;}};ComponentArt_ComboBox.prototype.RemoveItemAt=function(_95){if(_95>=0&&_95<this.Data.length){this.Data=this.Data.slice(0,_95).concat(this.Data.slice(_95+1));this.ItemCount--;this.LoadedItemCount--;this.TextCache.length=0;this.CssClasses.length=0;}};ComponentArt_ComboBox.prototype.Render=function(_96){this.element=this.DomElement=document.getElementById(this.DomElementId);if(this.element){this.element.className=this.CssClass;}if(this.TextBoxClientTemplateId){var _97=document.getElementById(this.Id+"_TextBox");if(_97){var _98=this.GetClientTemplate(this.TextBoxClientTemplateId);if(_98){var _99=ComponentArt_InstantiateClientTemplate(_98,this,this.GetSelectedItem());if(_99){var _9a="#$InputBox";if(_99.indexOf(_9a)>=0){var _9b=document.getElementById(this.Id+"_Input");if(_9b){if(this.InputBox){this.RestoreInputBox();}var _9c="<div id=\""+this.Id+"_InputBoxPlaceHolder\" style=\"overflow:hidden;height:"+_9b.offsetHeight+"px;width:"+_9b.offsetWidth+"px;\">&nbsp;</div>";_99=_99.replace(_9a,_9c);var _9d=document.createElement("div");_9d.innerHTML=_9c;this.ContainerObj.appendChild(_9b.parentNode.replaceChild(_9d,_9b));this.InputBox=_9b;}}_97.innerHTML=_99;if(this.InputBox){clearTimeout(this.RestoreInputBoxTimeout);this.RestoreInputBoxTimeout=setTimeout(this.Id+".RestoreInputBox()",0);}}}}}else{if(this.TextBoxEnabled){var _9b=document.getElementById(this.Id+"_Input");if(_9b){_9b.className=this.TextBoxCssClass;}}else{var _97=document.getElementById(this.Id+"_TextBox");if(_97){_97.className=this.TextBoxCssClass;}}}var _9e=document.getElementById(this.Id+"_CacheMap");if(_9e){this.RenderCacheMap(_9e);}if(_96){this.RenderDropDown();}};ComponentArt_ComboBox.prototype.RenderCacheMap=function(_9f){var _a0=["<table width=\""+this.CacheMapWidth+"\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">"];for(var i=0;i<_9f.offsetHeight;i++){var _a2=this.Data[Math.round((i*this.ItemCount)/_9f.offsetHeight)];var _a3=_a2?(_a2.length==0?this.CacheMapLoadingColor:this.CacheMapLoadedColor):this.CacheMapNotLoadedColor;_a0[_a0.length]="<tr><td height=\"1\" bgcolor=\""+_a3+"\"></td></tr>";}_a0[_a0.length]="</table>";_9f.innerHTML=_a0.join("");};ComponentArt_ComboBox.prototype.RenderDropDown=function(){if(this.HasDropDownContent){return;}var _a4=document.getElementById(this.Id+"_DropDownContent");if(_a4){var _a5=0;var _a6=[];for(var i=0;i<this.ItemCount;i++){var _a8=i<this.Data.length?this.GetItem(i):null;if(_a8){this.TextCache[i]=_a8.Text;if(!this.FilterString||(this.FilterString&&this.TextCache[i].toLowerCase().indexOf(this.FilterString)==0)){if(_a5>0){this.RenderMissingItems(_a6,_a5);_a5=0;}this.RenderItem(_a8,_a6);}}else{_a5++;}}if(_a5>0){this.RenderMissingItems(_a6,_a5);_a5=0;}_a4.innerHTML=_a6.join("");}};ComponentArt_ComboBox.prototype.RenderItem=function(_a9,_aa){var _ab=_a9.CssClass?_a9.CssClass:this.ItemCssClass;if(!_a9.Enabled&&this.DisabledItemCssClass){_ab+=" "+this.DisabledItemCssClass;}if(this.SelectedItemCssClass&&_a9.Index==this.SelectedIndex){_ab+=" "+this.SelectedItemCssClass;}var _ac=this.SelectedItemHoverCssClass&&_a9.Index==this.SelectedIndex?this.SelectedItemHoverCssClass:this.ItemHoverCssClass;this.CssClasses[_a9.Index]={"Base":_ab,"Hover":_ac};_aa[_aa.length]="<div style=\"text-wrap:none;\" id=\""+this.Id+"_item_"+_a9.Index+"\"";if(_ab){_aa[_aa.length]=" class=\""+_ab+"\"";}if(_a9.Enabled){if(_ac){_aa[_aa.length]=" onmouseover=\""+this.Id+".HandleItemMouseOver(event,this, "+_a9.Index+");\"";_aa[_aa.length]=" onmouseout=\""+this.Id+".HandleItemMouseOut(event,this, "+_a9.Index+");\"";}_aa[_aa.length]=" onclick=\""+this.Id+".HandleClick(event,this,"+_a9.Index+")\"";}_aa[_aa.length]=" onmousedown=\"ComponentArt_CancelEvent(event)\"><nobr>";var _ad=_a9.ClientTemplateId?_a9.ClientTemplateId:this.ItemClientTemplateId;if(_ad){var _ae=this.GetClientTemplate(_ad);if(_ae){var _af=ComponentArt_InstantiateClientTemplate(_ae,this,_a9);if(_af){_aa[_aa.length]=_af;}}}else{_aa[_aa.length]=_a9.Text;}_aa[_aa.length]="</nobr></div>";};ComponentArt_ComboBox.prototype.RenderMissingItem=function(_b0){_b0[_b0.length]="<div style=\"visibility:hidden;overflow:hidden;\" class=\""+this.ItemCssClass+"\">&nbsp;</div>";};ComponentArt_ComboBox.prototype.RenderMissingItems=function(_b1,_b2){_b1[_b1.length]="<div style=\"visibility:hidden;overflow:hidden;height:"+(_b2*this.ItemHeight)+"px;\">&nbsp;</div>";};ComponentArt_ComboBox.prototype.RestoreInputBox=function(){if(this.InputBox){var _b3=document.getElementById(this.Id+"_InputBoxPlaceHolder");if(_b3){_b3.parentNode.replaceChild(this.InputBox,_b3);this.InputBox.focus();this.InputBox=null;}else{clearTimeout(this.RestoreInputBoxTimeout);this.RestoreInputBoxTimeout=setTimeout(this.Id+".RestoreInputBox()",10);}}};ComponentArt_ComboBox.prototype.SaveData=function(){var _b4=document.getElementById(this.Id+"_Data");if(_b4){_b4.value=ComponentArt_ArrayToXml(this.Data,true);}};ComponentArt_ComboBox.prototype.ScrollIntoView=function(_b5){var _b6=document.getElementById(this.Id+"_item_"+_b5);var _b7=document.getElementById(this.Id+"_DropDownContent");if(_b6){if(_b6.offsetTop+_b6.offsetHeight>_b7.scrollTop+_b7.offsetHeight||_b6.offsetTop<_b7.scrollTop){_b7.scrollTop=_b6.offsetTop;}}};ComponentArt_ComboBox.prototype.SelectItem=function(_b8){if(!_b8.Enabled){return;}var _b9=_b8.Index;if(_b9==this.SelectedIndex){return;}if(this.SelectedItemCssClass){if(this.SelectedIndex>=0){var _ba=this.GetItem(this.SelectedIndex);if(_ba){var _bb=_ba.CssClass?_ba.CssClass:this.ItemCssClass;if(this.CssClasses[this.SelectedIndex]){this.CssClasses[this.SelectedIndex].Base=_bb;if(this.ItemHoverCssClass){this.CssClasses[this.SelectedIndex].Hover=_bb+" "+this.ItemHoverCssClass;}}var _bc=document.getElementById(this.Id+"_item_"+this.SelectedIndex);if(_bc){_bc.className=_bb;}}}if(this.CssClasses[_b9]){this.CssClasses[_b9].Base+=" "+this.SelectedItemCssClass;if(this.SelectedHoverCssClass){this.CssClasses[_b9].Hover+=" "+this.SelectedHoverCssClass;}var _bd=document.getElementById(this.Id+"_item_"+_b9);if(_bd){_bd.className=this.CssClasses[_b9].Base;}}}this.SelectedIndex=_b9;var _be=document.getElementById(this.Id+"_SelectedIndex");if(_be){_be.value=_b9;}var _bf=document.getElementById(this.Id+"_Input");if(_bf){_bf.value=_b8.Text;}this.Render();this.ScrollIntoView(_b9);var _c0=this.get_events().getHandler("change");if(_c0){_c0(this,Sys.EventArgs.Empty);}};ComponentArt_ComboBox.prototype.SelectItemByIndex=function(_c1){var _c2=this.GetItem(_c1);if(_c2){this.SelectItem(_c2);}};ComponentArt_ComboBox.prototype.ShowOverlay=function(){if(!cart_browser_ie){return;}if(!this.OverlayElement){var _c3=document.createElement("iframe");_c3.src="javascript:false";_c3.style.position="absolute";if(cart_browser_ie){_c3.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";}else{_c3.style.opacity=0;_c3.style.setProperty("-moz-opacity",0,"");}document.body.insertBefore(_c3,document.body.firstChild);this.OverlayElement=_c3;}var _c4=document.getElementById(this.Id+"_DropDown");this.OverlayElement.style.top=_c4.style.top;this.OverlayElement.style.left=_c4.style.left;this.OverlayElement.style.width=_c4.offsetWidth+"px";this.OverlayElement.style.height=_c4.offsetHeight+"px";this.OverlayElement.style.border="1px solid black";this.OverlayElement.style.display="block";};ComponentArt_ComboBox.prototype.ShowReloading=function(){var _c5=document.getElementById(this.Id+"_DropDownContent");_c5.innerHTML="";if(!this.Expanded){return;}if(!this.CallbackProgressDomObj){this.CallbackProgressDomObj=document.createElement("div");this.CallbackProgressDomObj.style.position="absolute";this.CallbackProgressDomObj.style.display="none";this.CallbackProgressDomObj.style.textAlign="center";if(this.LoadingClientTemplateId){var _c6=this.GetClientTemplate(this.LoadingClientTemplateId);if(_c6){var _c7=ComponentArt_InstantiateClientTemplate(_c6,this,null);if(_c7){this.CallbackProgressDomObj.innerHTML=_c7;}}}else{this.CallbackProgressDomObj.innerHTML=this.LoadingText;}document.body.insertBefore(this.CallbackProgressDomObj,document.body.firstChild);}var _c5=document.getElementById(this.Id+"_DropDownContent");if(_c5){this.CallbackProgressDomObj.style.top=_q86(_c5)+"px";this.CallbackProgressDomObj.style.left=_q85(_c5)+"px";this.CallbackProgressDomObj.style.width=ComponentArt_GetAdjustedWidth(_c5)+"px";this.CallbackProgressDomObj.style.height=ComponentArt_GetAdjustedHeight(_c5)+"px";this.CallbackProgressDomObj.style.zIndex=_c5.style.zIndex+1;this.CallbackProgressDomObj.style.display="";}};ComponentArt_ComboBox.prototype.ToggleExpand=function(){if(this.Expanded){this.Collapse();}else{this.Expand();}};ComponentArt_ComboBox.prototype.UnloadStalePage=function(){var _c8=this.PageViews.slice().sort(function(a,b){return (!a?1:!b?-1:a-b);});var _cb=_c8[0];for(var i=0;i<this.PageViews.length;i++){if(this.PageViews[i]==_cb){this.PageViews[i]=null;var _cd=i*this.DropDownPageSize;var _ce=_cd+this.DropDownPageSize;for(var j=_cd;j<_ce;j++){this.Data[j]=null;}this.LoadedItemCount-=(_ce-_cd);break;}}};ComponentArt_ComboBox.prototype.UnSelect=function(){if(this.SelectedItemCssClass){if(this.SelectedIndex>=0){var _d0=this.GetItem(this.SelectedIndex);if(_d0){var _d1=_d0.CssClass?_d0.CssClass:this.ItemCssClass;this.CssClasses[this.SelectedIndex].Base=_d1;if(this.ItemHoverCssClass){this.CssClasses[this.SelectedIndex].Hover=_d1+" "+this.ItemHoverCssClass;}var _d2=document.getElementById(this.Id+"_item_"+this.SelectedIndex);if(_d2){_d2.className=_d1;}}}}this.SelectedIndex=-1;var _d3=document.getElementById(this.Id+"_SelectedIndex");if(_d3){_d3.value=-1;}this.Render();this.ScrollIntoView(0);var _d4=this.get_events().getHandler("change");if(_d4){_d4(this,Sys.EventArgs.Empty);}};window.ComponentArt_ComboBox_Kernel_Loaded=true;}
